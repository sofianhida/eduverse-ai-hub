
// This file is automatically generated. Do not edit it directly.
import { createClient } from '@supabase/supabase-js';
import type { Database } from './types';

const SUPABASE_URL = "https://kdpdyjmwtgkjhupcowlm.supabase.co";
const SUPABASE_PUBLISHABLE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtkcGR5am13dGdramh1cGNvd2xtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI2MjQ0MzgsImV4cCI6MjA1ODIwMDQzOH0.ILabT0YBQmW6yztTNXn9_4Ojm5lkjPWVhgsH9lvjlMg";

// Import the supabase client like this:
// import { supabase } from "@/integrations/supabase/client";

export const supabase = createClient<Database>(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY, {
  auth: {
    autoRefreshToken: true,
    persistSession: true,
    detectSessionInUrl: true
  }
});

// Helper function to get features for admin/teacher module
export const getAdminFeatures = async () => {
  try {
    // For now, return mock data since the table might not exist yet
    return [
      {
        id: '1',
        title: 'Manajemen Siswa',
        description: 'Kelola data siswa dengan mudah dan efisien',
        icon_name: 'Users',
        display_order: 1
      },
      {
        id: '2',
        title: 'Analisis Prestasi',
        description: 'Dapatkan wawasan tentang kinerja akademik siswa',
        icon_name: 'BarChart4',
        display_order: 2
      },
      {
        id: '3',
        title: 'Jadwal Terpadu',
        description: 'Kelola jadwal kelas dan kegiatan sekolah',
        icon_name: 'Calendar',
        display_order: 3
      },
      {
        id: '4',
        title: 'Laporan Otomatis',
        description: 'Buat laporan akademik dan administrasi secara otomatis',
        icon_name: 'FileText',
        display_order: 4
      }
    ];
  } catch (error) {
    console.error('Error fetching admin features:', error);
    return [];
  }
};

// Helper function to get features for student module
export const getStudentFeatures = async () => {
  try {
    // For now, return mock data since the table might not exist yet
    return [
      {
        id: '1',
        title: 'Tutor AI Personal',
        description: 'Belajar dengan bantuan AI yang menyesuaikan dengan gaya belajar Anda',
        icon_name: 'GraduationCap',
        display_order: 1
      },
      {
        id: '2',
        title: 'Latihan Soal Cerdas',
        description: 'Latihan soal yang menyesuaikan dengan tingkat kemampuan Anda',
        icon_name: 'BrainCircuit',
        display_order: 2
      },
      {
        id: '3',
        title: 'Rangkuman Materi',
        description: 'Rangkuman otomatis dari materi pelajaran yang membantu pemahaman',
        icon_name: 'BookOpenCheck',
        display_order: 3
      },
      {
        id: '4',
        title: 'Konsultasi Virtual',
        description: 'Tanyakan pertanyaan dan dapatkan jawaban secara real-time',
        icon_name: 'MessageSquare',
        display_order: 4
      }
    ];
  } catch (error) {
    console.error('Error fetching student features:', error);
    return [];
  }
};

// Function to check Supabase connection status
export const checkSupabaseConnection = async () => {
  try {
    const { error } = await supabase.from('profiles').select('count', { count: 'exact', head: true });
    return { connected: !error, error: error ? error.message : null };
  } catch (err) {
    console.error('Supabase connection check failed:', err);
    return { connected: false, error: err instanceof Error ? err.message : 'Unknown error' };
  }
};
